<!DOCTYPE html>

<html>

<head>
    <title>Car Playground</title>

    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-colorpicker/3.2.0/css/bootstrap-colorpicker.css">

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
    
    <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-colorpicker/3.2.0/js/bootstrap-colorpicker.js"></script>    


    <script type="application/javascript" src="js/three.min.js"></script>
    <script type="application/javascript" src="js/simplex-noise.js"></script>
    <script type="application/javascript" src="js/physi.js"></script>
    <script type="application/javascript" src="./src/walls.js"></script>
    <script type="application/javascript" src="./src/rain.js"></script>
    <script type="application/javascript" src="./src/snow.js"></script>
    <script type="application/javascript" src="./src/bowling.js"></script>
    <script type="application/javascript" src="./src/ramp.js"></script>
    <script type="application/javascript" src="./src/light.js"></script>
    <script type="application/javascript" src="./src/boxes.js"></script>
    <script type="application/javascript" src="./src/ground.js"></script>
    <script type="application/javascript" src="./src/mapBorder.js"></script>
    <script type="application/javascript" src="./src/car.js"></script>
    <script type="application/javascript" src="index.js"></script>


</head>

<body>
    <div class="accordion" id="panel" style="position:absolute;width: 300px;">
        <div class="card">
            <div class="card-header" id="headingOne">
                <button class="btn btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseOne"
                    aria-expanded="true" aria-controls="collapseOne" id="header">
                    <center>
                        <h4 class="mb-0" id="title">Control Panel ▲</h4>
                    </center>
                </button>
            </div>
            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#panel"
                style="width: 300px;">
                <div class="card-body" style="padding: 0px;">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><label>Box Color:</label><div name="boxColor"
                            id="boxColor" style="float:right;width: 15px;height: 15px;background-color: red;"></div>
                            <div id="cp2" class="input-group colorpicker-component">
                                <input id="colorInput" type="text" value="#ff0000" class="form-control"/>
                                <span class="input-group-addon"><i></i></span>
                            </div>
                        </li>
                        <li class="list-group-item"><label>Box Density:</label><output name="boxDensityText"
                                id="boxDensityText" style="float:right;">5</output>
                            <input type="range" class="custom-range" value="5" min="1" max="10"
                                oninput="boxDensityText.value = this.value">
                        </li>
                        <li class="list-group-item"><label>Box Size:</label><output name="boxSizeText"
                                id="boxSizeText" style="float:right;">5</output>
                            <input type="range" class="custom-range" value="5" min="1" max="10"
                                oninput="boxSizeText.value = this.value">
                        </li>
                        <li class="list-group-item" id="weather"><label style="margin-right: 20px;">Weather:</label>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" id="rain" name="weather" class="custom-control-input" checked>
                                <label class="custom-control-label" for="rain">Rain</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" id="snow" name="weather" class="custom-control-input">
                                <label class="custom-control-label" for="snow">Snow</label>
                            </div>
                        </li>
                        <li class="list-group-item"><label>Particle Density:</label><output name="particleDensityText"
                                id="particleDensityText" style="float:right;">5</output>
                            <input type="range" class="custom-range" value="5" min="1" max="10"
                                oninput="particleDensityText.value = this.value">
                        </li>
                        <li class="list-group-item"><label>Particle Size:</label><output name="particleSizeText"
                                id="particleSizeText" style="float:right;">5</output>
                            <input type="range" class="custom-range" value="5" min="1" max="10"
                                oninput="particleSizeText.value = this.value">
                        </li>
                        <li class="list-group-item">
                            <center><button type="button" class="btn btn-primary" id="apply">Apply</button>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <audio id="rainAudio" loop autoplay="true">
            <source src="audio/rain.mp3" type="audio/mp3">
        </audio>
        <audio id="snowAudio" loop>
            <source src="audio/snow.mp3" type="audio/mp3">
        </audio>
        <audio id="engineAudio" loop>
            <source src="audio/engine.mp3" type="audio/mp3">
        </audio>
    </div>
    <div id="viewport"></div>
    <script>
        $(function() {
            $('#cp2').colorpicker();
        });

        $("#colorInput").change(function() { 
            $("#boxColor").css("background-color",$(this).val());
        });

        var boxColor = 0xff0000;
        boxDensity = 5, //1-10
        boxSize = 5, //1-10
        weather = "rain", //"rain" or "snow"
        particleDensity = 5, //1-10
        particleSize = 5, //1-10
        particleSpeed = 5; //1-10

        var rainAudio = document.getElementById("rainAudio"); 
        var snowAudio = document.getElementById("snowAudio"); 
        var engineAudio = document.getElementById("engineAudio");
        rainAudio.play();

        $("#header").click(function () {
            if ($("#header").attr("aria-expanded") === "true") {
                $("#title").text("Control Panel ▼");
            } else {
                $("#title").text("Control Panel ▲");
            }
        });

        $("#apply").click(function(){
            boxColor = $("#boxColor").css( "background-color" );
            boxDensity = $("#boxDensityText").text();
            boxSize = $("#boxSizeText").text();
            weather = $("#weather :checked").attr("id");
            particleDensity = $("#particleDensityText").text();
            particleSize = $("#particleSizeText").text();
            
            if(weather==="rain"){
                if(scene.getObjectByName("rain")){
                    deleteRain();
                    deleteClouds();
                }else if(scene.getObjectByName("snow")){
                    deleteSnow();
                }
                snowAudio.pause();
                rainAudio.play();
                createRain();
            }else if(weather==="snow"){
                if(scene.getObjectByName("rain")){
                    deleteRain();
                    deleteClouds();
                }else if(scene.getObjectByName("snow")){
                    deleteSnow();
                }
                rainAudio.pause();
                snowAudio.play();
                createSnow();
            }

            clearBox();
            createBoxes();
        });

    </script>
</body>

</html>
